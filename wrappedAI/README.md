# AI Wrapped – Chrome Extension (MVP)

This readme was generated by claude it might be incorrect but i can answer any questions

AI Wrapped is a Chrome extension that tracks AI chat usage sessions on supported platforms and stores conversation data locally. This repository contains an MVP focused on session tracking, message extraction, and local persistence.

---

## Supported Platforms

- ChatGPT (chat.openai.com)
- Claude (claude.ai) – detection only, extraction not yet implemented

---

## Data Collected

When tracking is enabled, the extension stores one conversation object per session with the following fields:

- `convo_id` – unique UUID per session
- `tab_id` – Chrome tab ID
- `platform` – `chatgpt`
- `chat_title` – page title at time of capture
- `start_time` – ISO timestamp when tracking starts
- `end_time` – ISO timestamp when tracking stops
- `duration` – session duration in seconds
- `chat_msgs` – ordered array of message objects:
  - `role` (`user` or `assistant`)
  - `content` (full message text)

All data is stored in `chrome.storage.local` under the key `allConvos`.

---

## Architecture Overview

- **Popup (Wrapped.jsx)**
  - Provides UI for starting and stopping tracking
  - Displays mock "Wrapped" data for UI development
  - Sends tracking commands to the background script

- **Background Script (background.js)**
  - Validates active tab and platform
  - Manages global tracking state
  - Saves completed conversations to local storage

- **Content Script (content.js)**
  - Detects active ChatGPT conversations
  - Extracts messages from the DOM
  - Computes session duration
  - Sends completed conversation data to the background script

---

## Installation (Developer Mode)

1. Open `chrome://extensions`
2. Enable **Developer mode**
3. Click **Load unpacked**
4. Select the extension directory
5. (Optional) Pin the extension for easy access

---

## Manual Testing Instructions

### Start Tracking

1. Open a ChatGPT conversation
2. Click the extension icon
3. Select **Manage Tracking**
4. Click **Start Tracking**

If the active tab is not a supported platform, the extension will show an error message.

### During Tracking

- Send at least one user message and receive one assistant response
- Message extraction runs every 5 seconds once a conversation is detected

### Stop Tracking

1. Click **Stop Tracking** in the popup
2. The session is finalized and saved to local storage

If no valid conversation was detected, no data is saved.

---

## Verifying Saved Data

Open the Chrome DevTools console and run:

```js
chrome.storage.local.get({ allConvos: [] }, console.log)
```

You should see an array of conversation objects. Each object will have the structure described in the "Data Collected" section above.

---

## Current Status & Known Limitations

### Working
- ChatGPT message extraction
- Start/Stop tracking from popup
- Local storage persistence
- Session duration tracking

### Not Yet Implemented
- Claude.ai extraction (detection only)
- UI visualization of real data (intentionally using mock data)
- Message timestamps (removed for simplicity)
- Multi-session tracking (only one conversation per tracking session)

### Known Issues
- Messages are re-extracted every 5 seconds, overwriting previous snapshot
- Rapid start/stop may not capture any messages
- Closing tab while tracking loses the session

---

## Debugging

### Content Script Console (ChatGPT page)

Check for these logs:
- "Content script received message"
- "saved messages, message count: X"
- "sending the NEW_CONVO to chrome storage"

### Background Script Console

1. Go to `chrome://extensions`
2. Click "service worker" under the extension
3. Look for "Saved current tracking state" logs

### Popup Console

Right-click popup → Inspect → Console

---

## Conversation Data Structure

Example of a saved conversation object:

```json
{
  "convo_id": "3350e725-8ee9-4c40-a1fa-0d62d8f7254a",
  "tab_id": 859880101,
  "platform": "chatgpt",
  "chat_title": "Popular TV Shows 2024",
  "start_time": "2026-01-12T03:20:00.000Z",
  "end_time": "2026-01-12T03:20:15.066Z",
  "duration": 15.066,
  "chat_msgs": [
    {
      "role": "user",
      "content": "What are some popular TV shows?"
    },
    {
      "role": "assistant",
      "content": "Here are some popular TV shows..."
    }
  ],
  "chat_cat": null
}
```
